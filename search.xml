<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>使用VBA输出UTF-8</title>
      <link href="/2018/06/19/vba-out-utf8/"/>
      <url>/2018/06/19/vba-out-utf8/</url>
      <content type="html"><![CDATA[<p>输出utf-8</p><pre><code>Public Function writeOut(cText As String, file As String) As Integer    On Error GoTo errHandler    Dim fsT    &apos;Create Stream object    Set fsT = CreateObject(&quot;ADODB.Stream&quot;)    &apos;Specify stream type - we want To save text/string data.    fsT.Type = 2    &apos;Specify charset For the source text data.    fsT.Charset = &quot;utf-8&quot;    &apos;Open the stream And write binary data To the object    fsT.Open    fsT.writetext cText    &apos;Save binary data To disk    fsT.SaveToFile file, 2    GoTo finisherrHandler:    MsgBox (Err.Description)    writeOut = 0    Exit Functionfinish:    writeOut = 1End Function</code></pre><p>调用方法 <code>Call writeOut(datastr, filePath)</code></p><p>参考网址: <a href="https://gist.github.com/JoBrad/1023484" target="_blank" rel="noopener">https://gist.github.com/JoBrad/1023484</a></p>]]></content>
      
      
    </entry>
    
  
  
</search>
